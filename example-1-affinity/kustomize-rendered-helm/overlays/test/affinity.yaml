apiVersion: apps/v1
kind: Deployment
metadata:
  name: contrast-agent-operator
  namespace: contrast-agent-operator
spec:
  replicas: 1
  template:
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
              - matchExpressions:
                  - key: kubernetes.io/os
                    operator: In
                    values:
                      - linux
                  - key: kubernetes.io/arch
                    operator: In
                    values:
                      - amd64
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                # matchLabels:
                #   app: example-webgoat
                matchExpressions:
                  - key: app
                    operator: In
                    values:
                      - example-webgoat
                # - key: app.kubernetes.io/part-of
                #   operator: In
                #   values:
                #     - contrast-agent-operator
              topologyKey: kubernetes.io/hostname
              #weight: 100
